# This is the main configuration for the OpenObserve Helm chart
# We will enable all the sub-charts to create a self-contained cluster.
# Required secrets: see required-secrets.yaml in this directory.

resources:
  limits:
    cpu: 300m
    memory: 2Gi 
  requests:
    cpu: 100m
    memory: 1Gi 

# OpenObserve Application Configuration
config:
  # Tells OpenObserve to run in HA mode
  ZO_LOCAL_MODE: "false"
  
  # --- Metadata Store (PostgreSQL) ---
  # We are using the built-in PostgreSQL sub-chart.
  # The chart is smart and will automatically configure the
  # DSN (connection string) when postgresql.enabled is true.
  ZO_META_STORE: "postgres"

  # --- Cluster Coordinator (NATS) ---
  # We are using the built-in NATS sub-chart.
  # The chart will automatically configure the NATS server URLs.
  ZO_CLUSTER_COORDINATOR: "nats"

  # --- Object Storage (MinIO) ---
  # We are using the built-in MinIO sub-chart.
  # The chart will automatically configure the S3 endpoint and keys.
  ZO_S3_BUCKET_NAME: "openobserve-logs" # You can change this if you want

auth:
  existingSecret: "openobserve-root-creds"

postgres:
  enabled: true
  spec:
    instances: 3
    storage:
      size: 1Gi
      storageClass: local-path

ingester:
  persistence:
    size: 10Gi
    storageClass: local-path

querier:
  persistence:
    size: 10Gi
    storageClass: local-path

alertmanager:
  persistence:
    size: 1Gi
    storageClass: local-path

# NATS: chart uses nats.config.jetstream.fileStore.pvc
nats:
  enabled: true
  config:
    cluster:
      enabled: true
      replicas: 3
    jetstream:
      enabled: true
      fileStore:
        enabled: true
        pvc:
          enabled: true
          size: 5Gi
          storageClassName: local-path
  resources:
    limits:
      cpu: 100m
      memory: 256Mi
    requests:
      cpu: 25m
      memory: 128Mi

# MinIO sub-chart settings
minio:
  enabled: true
  replicas: 3
  persistence:
    size: 40Gi
    storageClass: local-path
  resources:
    limits:
      cpu: 200m
      memory: 384Mi
    requests:
      cpu: 50m
      memory: 256Mi